(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-79cf9527"],{2049:function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"myspinner"},[t.loading?o("atom-spinner",{attrs:{"animation-duration":t.speed,size:t.config.size,color:t.spinnersColor}}):t._e()],1),t._m(0),o("form",{on:{submit:function(e){e.preventDefault(),t.showOTP?t.submitFinal():t.onsubmit()}}},[t.showOTP?t._e():o("va-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{type:"text",label:t.$t("auth.email-or-phone"),placeholder:t.$t("auth.enter-email-or-phone"),error:!!t.emailErrors.length,"error-messages":t.emailErrors},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),t.showOTP?t._e():o("va-input",{attrs:{type:"password",label:t.$t("auth.password"),placeholder:t.$t("auth.enter-password"),error:!!t.passwordErrors.length,"error-messages":t.passwordErrors},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),t.showOTP?o("va-input",{attrs:{type:"text",label:t.$t("auth.otp"),error:!!t.otpErrors.length,"error-messages":t.otpErrors},model:{value:t.otp,callback:function(e){t.otp=e},expression:"otp"}}):t._e(),o("div",{staticClass:"d-flex justify--center mt-3"},[o("va-button",{staticClass:"my-0",staticStyle:{padding:"0.375rem 15.25rem","border-radius":"0.3rem","background-image":"linear-gradient(to right, #4ab0e1, #4ab0e1)"},attrs:{type:"submit",disabled:t.disableButton}},[t._v(t._s(t.$t("auth.login")))])],1)],1),o("br"),o("div",{staticClass:"auth-layout__options d-flex align--center"},[t._v(" Don't have an account yet? "),o("router-link",{staticClass:"ml-1 link",attrs:{to:{name:"signup"}}},[t._v(" "+t._s(t.$t("auth.createNewAccount"))+" ")])],1),o("div",{staticClass:"auth-layout__options d-flex align--center"},[t._v(" Forgot Pin? "),o("router-link",{staticClass:"ml-1 link",attrs:{to:{name:"recover-password"}}},[t._v(" "+t._s(t.$t("auth.recover_password"))+" ")])],1)])},s=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"login_copy-header",staticStyle:{"padding-bottom":"13px","padding-left":"7px",position:"relative","font-family":"Montserrat"}},[o("h2",{staticClass:"font-weight--medium mt-20",staticStyle:{"font-size":"1.25rem","font-weight":"500","line-height":"1.5rem"}},[t._v("Login")])])}],i=o("bc3a"),n=o.n(i),a=o("4583");function l(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,r)}return o}function c(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?l(Object(o),!0).forEach((function(e){u(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function u(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var d={components:c({},a),name:"login",data:function(){return{loading:!1,disableButton:!1,showOTP:!1,retries:4,conn:!1,otp:"",email:"",password:"",user_id:"",keepLoggedIn:!1,emailErrors:[],passwordErrors:[],errors:[],otpErrors:[],otp_no:"",token:"",config:{size:80,duration:1500},spinnersColor:"#4ab0e1",currentDuration:1500,sliderDuration:{min:1e3,max:2e3}}},computed:{speed:function(){return this.sliderDuration.min+this.sliderDuration.max-this.currentDuration},formReady:function(){return!this.emailErrors.length&&!this.passwordErrors.length&&!this.otpErrors.length}},methods:{checkConenction:function(){var t=this;n.a.get("".concat(this.$apiUrl,"pingAddress")).then((function(e){var o=e.data;0==o.success?(t.showToast("Could not establish a connection to your sacco please try again later",{position:"bottom-right",icon:"fa-times",duration:1e4}),t.conn=!1):t.conn=!0})).catch((function(t){console.log(t)}))},onsubmit:function(){this.emailErrors=this.email?[]:["Email is required"],this.passwordErrors=this.password?[]:["Password is required"];var t={email:this.email,password:this.password},e={data:t,readotp:{otp:"true",is_portal:"true"}};if(console.log(this.conn),this.formReady&&this.conn){this.disableButton=!0,this.loading=!0,localStorage.removeItem("LoggedUser"),localStorage.removeItem("UserMianFosa"),localStorage.removeItem("UserFosas");var o=this;n.a.post("".concat(this.$apiUrl,"AuthUser"),e).then((function(t){o.disableButton=!1;var e=t.data;console.log(e),o.loading=!1,0===e.success?(o.emailErrors=["Invalid Email/Phone No. or Password"],o.passwordErrors=["Invalid Email/Phone No. or Password"]):(o.retries=4,localStorage.setItem("LoggedUser",JSON.stringify(e.userData)),localStorage.setItem("Token",JSON.stringify(e.token)),o.user_id=e.userData.user_id,o.otp_no=e.otp,o.token=e.token,o.showOTP=!0,o.otpErrors=["Input OTP"],o.showToast("Successful! An OTP has been send to your Phone NO. Please input 4 digit OTP to Login",{position:"bottom-right",icon:"fa-check",duration:1e4}),setTimeout((function(){return o.showOTP=!1}),3e5))})).catch((function(t){console.log(t)}))}},login:function(){this.$router.push({name:"dashboard"})},submitFinal:function(){this.otpErrors=this.otp?[]:["OTP field field is required"];var t={otp:this.otp,user_id:this.user_id},e={headers:{Authorization:this.user_id+" "+this.token}};if(this.formReady&&this.retries>=1){this.retries=this.retries-1,this.loading=!0;var o=this;n.a.post("".concat(this.$apiUrl,"AuthOtpConfirm"),t,e).then((function(t){o.disableButton=!1;var e=t.data;o.loading=!1,1===e.success?o.login():o.otpErrors=["OTP does not match the one sent you have ".concat(o.retries," retries left")]})).catch((function(t){console.log(t)}))}else this.retries<=0&&(this.showOTP=!1)}},created:function(){this.checkConenction()},directives:{focus:{inserted:function(t){t.focus()}}}},h=d,p=(o("531a"),o("2877")),m=Object(p["a"])(h,r,s,!1,null,null,null);e["default"]=m.exports},"531a":function(t,e,o){"use strict";var r=o("d454"),s=o.n(r);s.a},d454:function(t,e,o){}}]);
//# sourceMappingURL=chunk-79cf9527.28aeee1b.js.map