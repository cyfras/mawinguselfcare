(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d0f2b"],{"69c5":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"funds-deposit"},[o("div",{staticStyle:{position:"fixed",top:"50%",left:"50%","z-index":"999"}},[t.loading?o("atom-spinner",{attrs:{"animation-duration":t.speed,size:t.config.size,color:t.spinnersColor}}):t._e()],1),t.processingError?o("div",{staticClass:"mb-3"},[o("va-notification",{attrs:{color:"danger",closeable:""}},[t._v(" An error occurred! Please Try again later. ")])],1):t._e(),o("div",{staticClass:"row"},[o("div",{staticClass:"flex xs12 md6 lg6"},[o("va-card",{attrs:{title:t.$t("activities.deposit_form")}},[o("form",{on:{submit:function(e){return e.preventDefault(),t.onsubmit(e)}}},[o("va-input",{attrs:{label:t.$t("amount"),type:"number",error:!!t.amountErrors.length,"error-messages":t.amountErrors},model:{value:t.formdata.amount,callback:function(e){t.$set(t.formdata,"amount",e)},expression:"formdata.amount"}}),o("va-select",{staticClass:"mb-4",attrs:{label:"Mode of Payment",textBy:"description",options:t.AccountTypes,"key-by":"id"},on:{input:t.setSelected},model:{value:t.formdata.type,callback:function(e){t.$set(t.formdata,"type",e)},expression:"formdata.type"}}),o("va-input",{attrs:{label:t.$t("mpesa-phone"),error:!!t.phoneErrors.length,"error-messages":t.phoneErrors},model:{value:t.formdata.phone_no,callback:function(e){t.$set(t.formdata,"phone_no",e)},expression:"formdata.phone_no"}}),o("div",{staticClass:"row mt-5"},[o("va-button",{attrs:{type:"submit"}},[t._v(" "+t._s(t.$t("forms.controls.submit"))+" ")])],1)],1)])],1)]),o("va-modal",{attrs:{position:"top",size:"medium",title:t.$t("confirm_trans"),cancelClass:"none",okText:t.$t("modal.confirm"),cancelText:t.$t("modal.cancel"),noOutsideDismiss:"",noEscDismiss:""},on:{ok:t.FinalPost},model:{value:t.showConfirmModal,callback:function(e){t.showConfirmModal=e},expression:"showConfirmModal"}},[o("table",{staticClass:"va-table va-table--striped va-table--hoverable",attrs:{width:"100%"}},[o("tbody",[o("tr",[o("td",[t._v("Account")]),o("td",{staticStyle:{"text-align":"right"}},[t._v(t._s(t.customer))])]),o("tr",[o("td",[t._v("Payment Phone No")]),o("td",{staticStyle:{"text-align":"right"}},[t._v(t._s(t.paying_phone_no))])]),o("tr",[o("td",[t._v("Amount")]),o("td",{staticStyle:{"text-align":"right"}},[t._v(" "+t._s(t._f("Currency")(t.deposit_amount))+" ")])]),o("tr",[o("td",[t._v("Payment Method")]),o("td",{staticStyle:{"text-align":"right"}},[t._v(" "+t._s(t.payment_method_name)+" ")])])])])])],1)},s=[],n=o("bc3a"),r=o.n(n),i=o("4583");function c(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,a)}return o}function d(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?c(Object(o),!0).forEach((function(e){l(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):c(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function l(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var m={components:d({},i),name:"funds-deposit",data:function(){return{userData:JSON.parse(localStorage.getItem("LoggedUser")),accdetails:JSON.parse(localStorage.getItem("UserMianFosa")),token:JSON.parse(localStorage.getItem("Token")),loading:!1,processingError:!1,loadSelect:!1,showConfirmModal:!1,acc_details:{accname:"",balance:""},deposit_amount:"",paying_phone_no:"",accounts:JSON.parse(localStorage.getItem("UserFosas")),fosas:JSON.parse(localStorage.getItem("UserFosas")),config:{size:80,duration:1500},spinnersColor:this.$themes.secondary,currentDuration:1500,sliderDuration:{min:1e3,max:2e3},formdata:{amount:"",user:"",acc_code:"",type:"",phone_no:""},amountErrors:[],phoneErrors:[],customer:"",payment_methodarr:[],payment_method:"",payment_method_name:"",AccountTypes:[{id:"",description:"select an option"},{id:"mpesa",description:"M-pesa"},{id:"card",description:"Card Payment"}],showBosa:!1,showFosa:!1,acc_code:{},selected:{},postdata:{}}},computed:{speed:function(){return this.sliderDuration.min+this.sliderDuration.max-this.currentDuration},formReady:function(){return!this.amountErrors.length&&!this.phoneErrors.length}},methods:{getSelected:function(t){return console.log(t),this.AccountTypes.find((function(e){return e.id.toLowerCase()==t.toLowerCase()}))},onsubmit:function(){this.processingError=!1,this.amountErrors=this.formdata.amount?[]:["Amount is required"],this.phoneErrors=this.formdata.phone_no?[]:["Phone No is required"],this.formReady&&(this.paying_phone_no=this.formdata.phone_no,this.payment_methodarr=this.getSelected(this.formdata.type.id),this.payment_method=this.payment_methodarr.id,this.payment_method_name=this.payment_methodarr.description,this.deposit_amount=this.formdata.amount,this.showConfirmModal=!0)},FinalPost:function(){var t="Enter M-pesa pin on paying phone to complete";this.loading=!0;var e=this,o={headers:{Authorization:this.userData.user_id+" "+this.token}};this.formdata.type=this.payment_method,r.a.post("".concat(this.$apiUrl,"depositMoneyFinal"),this.formdata,o).then((function(o){e.loading=!1,console.log(e.payment_method);var a=o.data;"1"==a.response.success?("mpesa"==e.payment_method&&e.showToast("Payment Processed succefully ".concat(t),{position:"bottom-right",icon:"fa-check",duration:2500}),"card"==e.payment_method&&(window.open(a.send.data.link,"_app"),console.log(a.send.data.link))):e.processingError=!0})).catch((function(t){console.log(t)}))},loadBosaAccs:function(){this.loadSelect=!0;var t=this,e={headers:{Authorization:this.userData.user_id+" "+this.token}};r.a.post("".concat(t.$apiUrl,"GetBackOfficeAccounts"),t.userData.user_id,e).then((function(e){t.accounts=e.data,t.loadSelect=!1})).catch((function(t){console.log(t)}))},setSelected:function(t){this.formdata.acc_code={};var e=t.id;e&&("fosa"==e?(this.accounts=this.fosas,this.loadSelect=!1,this.showFosa=!0,this.showBosa=!1):(this.showBosa=!0,this.showFosa=!1,this.loadBosaAccs()))}},created:function(){this.formdata.phone_no=this.userData.mobile_number,this.customer=this.userData.member_number,this.formdata.user=this.userData.user_id}},u=m,p=o("2877"),h=Object(p["a"])(u,a,s,!1,null,null,null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-2d0d0f2b.f01f9205.js.map