(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d0f2b"],{"69c5":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"funds-deposit"},[a("div",{staticStyle:{position:"fixed",top:"50%",left:"50%","z-index":"999"}},[t.loading?a("atom-spinner",{attrs:{"animation-duration":t.speed,size:t.config.size,color:t.spinnersColor}}):t._e()],1),t.processingError?a("div",{staticClass:"mb-3"},[a("va-notification",{attrs:{color:"danger",closeable:""}},[t._v(" An error occurred! Please Try again later. ")])],1):t._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"flex xs12 md6 lg6"},[a("va-card",{attrs:{title:t.$t("activities.deposit_form")}},[a("form",{on:{submit:function(e){return e.preventDefault(),t.onsubmit(e)}}},[a("va-input",{attrs:{label:t.$t("amount"),type:"number",error:!!t.amountErrors.length,"error-messages":t.amountErrors},on:{input:t.getDollars},model:{value:t.formdata.amount,callback:function(e){t.$set(t.formdata,"amount",e)},expression:"formdata.amount"}}),a("va-select",{staticClass:"mb-4",attrs:{label:"Mode of Payment",textBy:"description",options:t.AccountTypes,"key-by":"id"},on:{input:t.setSelected},model:{value:t.formdata.type,callback:function(e){t.$set(t.formdata,"type",e)},expression:"formdata.type"}}),t.showusd2?a("va-input",{attrs:{label:"USD Amount",type:"number",readonly:!0},model:{value:t.formdata.usd_amount,callback:function(e){t.$set(t.formdata,"usd_amount",e)},expression:"formdata.usd_amount"}}):t._e(),a("va-input",{attrs:{label:t.$t("mpesa-phone"),error:!!t.phoneErrors.length,"error-messages":t.phoneErrors},model:{value:t.formdata.phone_no,callback:function(e){t.$set(t.formdata,"phone_no",e)},expression:"formdata.phone_no"}}),a("div",{staticClass:"row mt-5"},[a("va-button",{attrs:{type:"submit"}},[t._v(" "+t._s(t.$t("forms.controls.submit"))+" ")])],1)],1)])],1)]),a("va-modal",{attrs:{position:"top",size:"medium",title:t.$t("confirm_trans"),cancelClass:"none",okText:t.$t("modal.confirm"),cancelText:t.$t("modal.cancel"),noOutsideDismiss:"",noEscDismiss:""},on:{ok:t.FinalPost},model:{value:t.showConfirmModal,callback:function(e){t.showConfirmModal=e},expression:"showConfirmModal"}},[a("table",{staticClass:"va-table va-table--striped va-table--hoverable",attrs:{width:"100%"}},[a("tbody",[a("tr",[a("td",[t._v("Account")]),a("td",{staticStyle:{"text-align":"right"}},[t._v(t._s(t.customer))])]),a("tr",[a("td",[t._v("Payment Phone No")]),a("td",{staticStyle:{"text-align":"right"}},[t._v(t._s(t.paying_phone_no))])]),a("tr",[a("td",[t._v("Amount")]),a("td",{staticStyle:{"text-align":"right"}},[t._v(" "+t._s(t._f("Currency")(t.deposit_amount))+" ")])]),t.showusd?a("tr",[a("td",[t._v("Charges")]),a("td",{staticStyle:{"text-align":"right"}},[t._v(" "+t._s(t._f("Currency")(t.total_charges))+" ")])]):t._e(),t.showusd?a("tr",[a("td",[t._v("Total ")]),a("td",{staticStyle:{"text-align":"right"}},[t._v(" "+t._s(t._f("Currency")(t.total_deduction))+" ")])]):t._e(),t.showusd?a("tr",[a("td",{attrs:{colspan:"2"}},[a("font",{attrs:{color:"red"}},[t._v("NB: An extra of Ksh."+t._s(t._f("Currency")(t.extra_charge))+" Will be charged on international transactions")])],1)]):t._e(),a("tr",[a("td",[t._v("Payment Method")]),a("td",{staticStyle:{"text-align":"right"}},[t._v(" "+t._s(t.payment_method_name)+" ")])])])])])],1)},r=[],s=a("bc3a"),n=a.n(s),i=a("4583");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach((function(e){d(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function d(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var h={components:l({},i),name:"funds-deposit",data:function(){return{userData:JSON.parse(localStorage.getItem("LoggedUser")),accdetails:JSON.parse(localStorage.getItem("UserMianFosa")),token:JSON.parse(localStorage.getItem("Token")),loading:!1,processingError:!1,loadSelect:!1,showConfirmModal:!1,acc_details:{accname:"",balance:""},deposit_amount:"",paying_phone_no:"",accounts:JSON.parse(localStorage.getItem("UserFosas")),fosas:JSON.parse(localStorage.getItem("UserFosas")),config:{size:80,duration:1500},spinnersColor:"#4ab0e1",currentDuration:1500,sliderDuration:{min:1e3,max:2e3},formdata:{amount:0,user:"",acc_code:"",type:"",phone_no:"",usd_amount:0,rate:0,chargable_amt:0},cft_charge:0,flutter_charge:0,ex_flutter_charge:0,total_charges:0,total_deduction:0,extra_charge:0,total_chargable:0,amountErrors:[],phoneErrors:[],customer:"",payment_methodarr:[],payment_method:"",payment_method_name:"",AccountTypes:[{id:"",description:"select an option"},{id:"mpesa",description:"M-pesa"},{id:"card",description:"Card Payment"}],showBosa:!1,showFosa:!1,showusd:!1,showusd2:!1,acc_code:{},selected:{},postdata:{}}},computed:{speed:function(){return this.sliderDuration.min+this.sliderDuration.max-this.currentDuration},formReady:function(){return!this.amountErrors.length&&!this.phoneErrors.length}},methods:{GetCustomerPackage:function(){var t=this,e={headers:{Authorization:this.userData.user_id+" "+this.token}};n.a.post("".concat(t.$apiUrl,"GetCustomerPackage"),this.userData.user_id,e).then((function(e){e=e.data,t.package_amount=t.$options.filters.Currency1(e.package_amount),t.due=parseFloat(e.balance.replace(/,/g,""))+parseFloat(e.package_amount.replace(/,/g,"")),t.formdata.amount=t.due,console.log(t.formdata.amount)})).catch((function(t){console.log(t)}))},getSelected:function(t){return console.log(t),this.AccountTypes.find((function(e){return e.id.toLowerCase()==t.toLowerCase()}))},onsubmit:function(){this.processingError=!1,this.amountErrors=this.formdata.amount?[]:["Amount is required"],this.phoneErrors=this.formdata.phone_no?[]:["Phone No is required"],this.formReady&&(this.paying_phone_no=this.formdata.phone_no,this.payment_methodarr=this.getSelected(this.formdata.type.id),this.payment_method=this.payment_methodarr.id,this.payment_method_name=this.payment_methodarr.description,this.deposit_amount=this.formdata.amount,this.showConfirmModal=!0)},FinalPost:function(){var t="Enter M-pesa pin on paying phone to complete";this.loading=!0;var e=this,a={headers:{Authorization:this.userData.user_id+" "+this.token}};this.showusd&&(this.formdata.chargable_amt=this.total_chargable),this.formdata.type=this.payment_method,n.a.post("".concat(this.$apiUrl,"depositMoneyFinal"),this.formdata,a).then((function(a){e.loading=!1,console.log(e.payment_method);var o=a.data;"1"==o.response.success?("mpesa"==e.payment_method&&e.showToast("Payment Processed succefully ".concat(t),{position:"bottom-right",icon:"fa-check",duration:2500}),"card"==e.payment_method&&(window.open(o.send.data.link,"_app"),console.log(o.send.data.link))):e.processingError=!0})).catch((function(t){console.log(t)}))},getUsdAmt:function(){var t=this.formdata.amount;this.cft_charge=.035*t,this.flutter_charge=2.9/100*(parseFloat(t)+parseFloat(this.cft_charge)),this.ex_flutter_charge=.038*(parseFloat(t)+parseFloat(this.cft_charge)),this.total_charges=parseFloat(this.flutter_charge)+parseFloat(this.cft_charge),this.total_deduction=parseFloat(this.flutter_charge)+parseFloat(this.cft_charge)+parseFloat(t),this.extra_charge=parseFloat(this.ex_flutter_charge)-parseFloat(this.flutter_charge),this.total_chargable=parseFloat(t)+parseFloat(this.cft_charge),this.loading=!0;var e=this,a={headers:{Authorization:this.userData.user_id+" "+this.token}};n.a.post("".concat(e.$apiUrl,"ExchangeRate"),this.total_chargable,a).then((function(t){var a=t.data.result;console.log(a),e.formdata.usd_amount=a.USD,e.formdata.rate=a.rate,e.loading=!1})).catch((function(t){console.log(t)}))},getDollars:function(t){console.log(t),"card"==this.pm&&this.getUsdAmt()},setSelected:function(t){var e=t.id;this.pm=e,e&&("card"==e?(this.showusd=!0,this.getUsdAmt()):this.showusd=!1)}},created:function(){this.formdata.phone_no=this.userData.mobile_number,this.customer=this.userData.member_number,this.formdata.user=this.userData.user_id,this.GetCustomerPackage()}},u=h,m=a("2877"),p=Object(m["a"])(u,o,r,!1,null,null,null);e["default"]=p.exports}}]);
//# sourceMappingURL=chunk-2d0d0f2b.1c85a4b8.js.map